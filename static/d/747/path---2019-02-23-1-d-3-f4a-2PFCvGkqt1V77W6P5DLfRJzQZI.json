{"data":{"site":{"siteMetadata":{"title":"ä¹å›­é—æ¢¦","author":"inori_lover"}},"markdownRemark":{"id":"06b53954-21b2-51e9-8fe9-6666173b52e5","excerpt":"ç¼˜ç”± åœ¨å†™å°ç¨‹åºçš„æ—¶å€™ä¼šå‘ç°æœ‰äº›åå°æäº¤çš„æ–‡ç« ä¼šå¯¼è‡´å°ç¨‹åºå´©æºƒå†»ä½ï¼Œæˆ–è€…å¤„ç†å‡½æ•°å‘ç”Ÿé”™è¯¯æ²¡æ³•èµ°ä¸‹å»ã€‚ä¸€å¼€å§‹æ²¡æ³¨æ„å› ä¸ºæ˜¯çœŸçš„å°æ¦‚ç‡äº‹ä»¶è€Œä¸”å¤ç°æ¡ä»¶ä¸æ˜ï¼Œç›´åˆ°æœ‰ä¸€å¤©å‘ç”Ÿè¿™ä¸ªéœ€æ±‚ï¼šæˆ‘éœ€è¦æŠŠæ–‡ç« ä¸€éƒ¨åˆ†åˆ‡å‰²å‡ºæ¥ä½œä¸ºåˆ†äº«URLâ€¦","html":"<h3>ç¼˜ç”±</h3>\n<p>åœ¨å†™å°ç¨‹åºçš„æ—¶å€™ä¼šå‘ç°æœ‰äº›åå°æäº¤çš„æ–‡ç« ä¼šå¯¼è‡´å°ç¨‹åºå´©æºƒå†»ä½ï¼Œæˆ–è€…å¤„ç†å‡½æ•°å‘ç”Ÿé”™è¯¯æ²¡æ³•èµ°ä¸‹å»ã€‚ä¸€å¼€å§‹æ²¡æ³¨æ„å› ä¸ºæ˜¯çœŸçš„å°æ¦‚ç‡äº‹ä»¶è€Œä¸”å¤ç°æ¡ä»¶ä¸æ˜ï¼Œç›´åˆ°æœ‰ä¸€å¤©å‘ç”Ÿè¿™ä¸ªéœ€æ±‚ï¼šæˆ‘éœ€è¦æŠŠæ–‡ç« ä¸€éƒ¨åˆ†åˆ‡å‰²å‡ºæ¥ä½œä¸ºåˆ†äº«URLå‚æ•°ä¸¢å‡ºæ¥ï¼Œè¿™ä¸ªé—®é¢˜å¯ä»¥ç¨³å®šå¤ç°äº†ï¼šæŸä¸€ç¯‡æ–‡ç« ç‚¹å‡»åˆ†äº«æŒ‰é’®æ²¡ååº”ã€‚ç»è¿‡ä¸€ç•ªdebugåæ‰å‘ç°æ˜¯emojiåˆ‡å‰²äº§ç”Ÿçš„åºŸå¼ƒå­—ç¬¦å¯¼è‡´ä¸‹é¢è¿™ç±»ä»£ç å‡ºé”™äº†ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token function\">encodeURIComponent</span><span class=\"token punctuation\">(</span><span class=\"token string\">'ğŸ˜®'</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span></code></pre></div>\n<h3>æ©ç›–</h3>\n<p>ç”±äºç¬¬ä¸€æ¬¡ç¢°åˆ°ç±»ä¼¼çš„é—®é¢˜ï¼Œjsä¹Ÿæ²¡æ‰¾åˆ°ä»€ä¹ˆåŸç”Ÿçš„apiå¯ä»¥ç”¨äºå®‰å…¨åˆ‡å‰²emojiå­—ç¬¦ä¸²ï¼Œåªèƒ½æš‚æ—¶è·Ÿè¿è¥å•†é‡å…ˆæŠŠemojiå¾€åç§»åŠ¨ï¼Œåªè¦æˆ‘éœ€è¦åˆ‡å‰²çš„éƒ¨åˆ†ä¸åŒ…å«å°±å®Œäº‹å¤§å‰äº†ã€‚ç»è¿‡ä¸¤ä¸ªæ±‰å ¡çš„è‰°éš¾è°ˆåˆ¤ä¹‹åæˆ‘å–å¾—äº†ä¸€ä¸ªç‰ˆæœ¬çš„å®½å®¹æœŸã€‚</p>\n<h3>ç¤¾åŒºæ–¹æ¡ˆ</h3>\n<p><a href=\"https://www.npmjs.com/package/emoji-aware\">emoji-aware</a>æ˜¯ç¬¬ä¸€ä¸ªæˆ‘èƒ½æ‰¾åˆ°çš„æ”¯æŒemojiåˆ‡å‰²çš„æ–¹æ¡ˆï¼Œå®ƒä¸ä»…æ”¯æŒæ™®é€šemojiè¿˜æ”¯æŒäº†é«˜ä½å¤åˆemoji(å¦‚ï¼šâ€™ğŸ‘¨â€ğŸ‘©â€ğŸ‘§â€ğŸ‘¦â€™)ï¼ŒæŸ¥çœ‹æºç ä¹‹åå‘ç°æ˜¯ä¸€ä¸ªå…ˆè½¬æˆarrayå¯¹arrayè¿›è¡Œåˆ‡å‰²åå†å¤åˆçš„<a href=\"https://github.com/beaugunderson/emoji-aware/blob/master/emoji-aware.js#L5\">æ€è·¯</a>ï¼Œä¸ºäº†æ”¯æŒé«˜ä½emojiè¿˜ç‰¹æ„å†™äº†ä¸€ä¸ªparseã€‚æ­£è§‰å¾—è¿˜è¡Œçš„æ—¶å€™å‘ç°è¯¥åº“çš„ç¬¬ä¸€è¡Œæœ‰ä¸€æ¡Note:</p>\n<blockquote>\n<p><em>Note:</em> Lodashâ€™s <code class=\"language-text\">toArray</code> (as of 4.0.0) and <code class=\"language-text\">split</code> (as of 4.9.0) functions\nnow correctly split strings that contain emoji; so if thatâ€™s all you need to do\nthen <a href=\"https://lodash.com/\">Lodash</a> is a great fit.</p>\n</blockquote>\n<p>å—¯å—¯ï¼Œæ˜¯ä½ äº†ã€‚</p>\n<h3>æœ€åï¼šLodash</h3>\n<p>ç»•äº†ä¸€åœˆå‘ç°ç»å¤§éƒ¨åˆ†çš„emojiå­—ç¬¦ä¸²åˆ‡å‰²éƒ½æ˜¯ä½¿ç”¨åŒä¸€ä¸ªæ€è·¯ï¼Œå…ˆæŠŠå­—ç¬¦ä¸²å±•å¼€æˆæ•°ç»„ï¼Œå¯¹æ•°ç»„è¿›è¡Œåˆ‡å‰²åå¤åˆä¸ºå­—ç¬¦ä¸²æ¥ä»£æ›¿ç›´æ¥å¯¹å­—ç¬¦ä¸²è¿›è¡Œæ“ä½œã€‚è¿™ä¸ªæ“ä½œæ€è·¯çš„æœ€å¤§å¥½å¤„æ˜¯å¯ä»¥è‡ªå®šä¹‰ä¸€ä¸ªå±•å¼€æ•°ç»„çš„é€»è¾‘æ¥æ”¯æŒå®šåˆ¶éœ€æ±‚ï¼ˆåœ¨è¿™é‡Œå°±æ˜¯å¯¹é«˜ä½unicodeå­—ç¬¦çš„æ­£ç¡®æ”¯æŒï¼‰ï¼Œå‰©ä¸‹çš„äº‹æƒ…å°±æ˜¯å¸¸è§„æ“ä½œï¼Œå¯ä»¥åä¸‹æ…¢æ…¢ç§€ã€‚</p>\n<p>ä¸‹è¾¹å°±æ˜¯ä»Lodashé‡Œè¾¹æŠ½å‡ºæ¥çš„å…³äºtoArrayçš„ä»£ç , ç”±äºLodashé‡Œè¾¹çš„toArrayè¿˜åŒ…å«äº†å¾ˆå¤šå…¶ä»–ç±»å‹å¯¹è±¡çš„æ”¯æŒä½†æ˜¯è¿™äº›å¯¹äºæˆ‘æ¥è¯´å…¶å®å¹¶æ²¡ç”¨æ‰€ä»¥è¿™é‡Œå°±åšäº†ç²¾ç®€ï¼Œç»“åˆåˆ‡å‰²éœ€æ±‚ç›´æ¥æŠŠæœ€åçš„éœ€æ±‚ä¸€èµ·å®ç°(copy-parse)äº†ã€‚</p>\n<blockquote>\n<p>ä»£ç è½¬æœ€åé™„å½•</p>\n</blockquote>\n<h3>æ±‚åŠ©ï¼Ÿ</h3>\n<p>å…¶å®åœ¨æœ€æ—©çš„æ—¶å€™ä¸Šç½‘æŸ¥è¯´é˜®ä¸€å³°è€å¸ˆæœ‰ä¸€ç¯‡åšæ–‡æåˆ°äº†å¦‚ä½•åˆ‡å‰²emojiä»¥åŠæ£€æµ‹æ˜¯å¦æœ‰è¢«å‰ªåˆ‡åçš„emojiï¼Œä½†æ˜¯å®åœ¨æ²¡æ‰¾åˆ°è¿™ç¯‡æ–‡ç« ï¼Ÿ</p>\n<p>å¦æœ€åè´´çš„ä¸€ä¸ªé“¾æ¥é‡Œè¾¹æ˜¯å…³äºdissé˜®ä¸€å³°è€å¸ˆçš„ã€‚ã€‚ã€‚ã€‚</p>\n<p>emmï¼Œæ€»ä½“æ¥è¯´æˆ‘è¿˜æ˜¯å¾ˆå°Šæ•¬è¿™ä½äº’è”ç½‘è€å…µçš„è´´å‡ºæ¥åªä¸è¿‡æ˜¯åˆšå¥½é‡Œè¾¹æ¶‰åŠåˆ°äº†å…³äºè¿™æ¬¡çš„ä¸»é¢˜ ç¼–ç  çš„ã€‚</p>\n<h3>æ¨èé˜…è¯»</h3>\n<ol>\n<li><a href=\"https://mathiasbynens.be/notes/javascript-unicode\">JavaScript has a Unicode problem Â· Mathias Bynens</a></li>\n<li><a href=\"http://www.ruanyifeng.com/blog/2017/04/emoji.html\">Emoji ç®€ä»‹</a></li>\n<li><a href=\"https://www.v2ex.com/t/343634?p=1\">é˜®ä¸€å³°çš„æ–‡ç« æœ‰å“ªäº›å¸¸è§æ€§é”™è¯¯</a></li>\n</ol>\n<h3>é™„å½•</h3>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token comment\">//@ts-check</span>\n<span class=\"token comment\">/** come from https://github.com/lodash/lodash/blob/4.17.11/lodash.js#L755 */</span>\n\n<span class=\"token comment\">/** Used to compose unicode character classes. */</span>\n<span class=\"token keyword\">var</span> rsAstralRange <span class=\"token operator\">=</span> <span class=\"token string\">'\\\\ud800-\\\\udfff'</span><span class=\"token punctuation\">,</span>\n    rsComboMarksRange <span class=\"token operator\">=</span> <span class=\"token string\">'\\\\u0300-\\\\u036f'</span><span class=\"token punctuation\">,</span>\n    reComboHalfMarksRange <span class=\"token operator\">=</span> <span class=\"token string\">'\\\\ufe20-\\\\ufe2f'</span><span class=\"token punctuation\">,</span>\n    rsComboSymbolsRange <span class=\"token operator\">=</span> <span class=\"token string\">'\\\\u20d0-\\\\u20ff'</span><span class=\"token punctuation\">,</span>\n    rsComboRange <span class=\"token operator\">=</span> rsComboMarksRange <span class=\"token operator\">+</span> reComboHalfMarksRange <span class=\"token operator\">+</span> rsComboSymbolsRange<span class=\"token punctuation\">,</span>\n    rsVarRange <span class=\"token operator\">=</span> <span class=\"token string\">'\\\\ufe0e\\\\ufe0f'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">/** Used to compose unicode capture groups. */</span>\n<span class=\"token keyword\">var</span> rsAstral <span class=\"token operator\">=</span> <span class=\"token string\">'['</span> <span class=\"token operator\">+</span> rsAstralRange <span class=\"token operator\">+</span> <span class=\"token string\">']'</span><span class=\"token punctuation\">,</span>\n    rsCombo <span class=\"token operator\">=</span> <span class=\"token string\">'['</span> <span class=\"token operator\">+</span> rsComboRange <span class=\"token operator\">+</span> <span class=\"token string\">']'</span><span class=\"token punctuation\">,</span>\n    rsFitz <span class=\"token operator\">=</span> <span class=\"token string\">'\\\\ud83c[\\\\udffb-\\\\udfff]'</span><span class=\"token punctuation\">,</span>\n    rsModifier <span class=\"token operator\">=</span> <span class=\"token string\">'(?:'</span> <span class=\"token operator\">+</span> rsCombo <span class=\"token operator\">+</span> <span class=\"token string\">'|'</span> <span class=\"token operator\">+</span> rsFitz <span class=\"token operator\">+</span> <span class=\"token string\">')'</span><span class=\"token punctuation\">,</span>\n    rsNonAstral <span class=\"token operator\">=</span> <span class=\"token string\">'[^'</span> <span class=\"token operator\">+</span> rsAstralRange <span class=\"token operator\">+</span> <span class=\"token string\">']'</span><span class=\"token punctuation\">,</span>\n    rsRegional <span class=\"token operator\">=</span> <span class=\"token string\">'(?:\\\\ud83c[\\\\udde6-\\\\uddff]){2}'</span><span class=\"token punctuation\">,</span>\n    rsSurrPair <span class=\"token operator\">=</span> <span class=\"token string\">'[\\\\ud800-\\\\udbff][\\\\udc00-\\\\udfff]'</span><span class=\"token punctuation\">,</span>\n    rsZWJ <span class=\"token operator\">=</span> <span class=\"token string\">'\\\\u200d'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">/** Used to compose unicode regexes. */</span>\n<span class=\"token keyword\">var</span> reOptMod <span class=\"token operator\">=</span> rsModifier <span class=\"token operator\">+</span> <span class=\"token string\">'?'</span><span class=\"token punctuation\">,</span>\n    rsOptVar <span class=\"token operator\">=</span> <span class=\"token string\">'['</span> <span class=\"token operator\">+</span> rsVarRange <span class=\"token operator\">+</span> <span class=\"token string\">']?'</span><span class=\"token punctuation\">,</span>\n    rsOptJoin <span class=\"token operator\">=</span> <span class=\"token string\">'(?:'</span> <span class=\"token operator\">+</span> rsZWJ <span class=\"token operator\">+</span> <span class=\"token string\">'(?:'</span> <span class=\"token operator\">+</span> <span class=\"token punctuation\">[</span>rsNonAstral<span class=\"token punctuation\">,</span> rsRegional<span class=\"token punctuation\">,</span> rsSurrPair<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span><span class=\"token function\">join</span><span class=\"token punctuation\">(</span><span class=\"token string\">'|'</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token string\">')'</span> <span class=\"token operator\">+</span> rsOptVar <span class=\"token operator\">+</span> reOptMod <span class=\"token operator\">+</span> <span class=\"token string\">')*'</span><span class=\"token punctuation\">,</span>\n    rsSeq <span class=\"token operator\">=</span> rsOptVar <span class=\"token operator\">+</span> reOptMod <span class=\"token operator\">+</span> rsOptJoin<span class=\"token punctuation\">,</span>\n    rsSymbol <span class=\"token operator\">=</span> <span class=\"token string\">'(?:'</span> <span class=\"token operator\">+</span> <span class=\"token punctuation\">[</span>rsNonAstral <span class=\"token operator\">+</span> rsCombo <span class=\"token operator\">+</span> <span class=\"token string\">'?'</span><span class=\"token punctuation\">,</span> rsCombo<span class=\"token punctuation\">,</span> rsRegional<span class=\"token punctuation\">,</span> rsSurrPair<span class=\"token punctuation\">,</span> rsAstral<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span><span class=\"token function\">join</span><span class=\"token punctuation\">(</span><span class=\"token string\">'|'</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token string\">')'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">/** Used to match [string symbols](https://mathiasbynens.be/notes/javascript-unicode). */</span>\n<span class=\"token keyword\">var</span> reUnicode <span class=\"token operator\">=</span> <span class=\"token function\">RegExp</span><span class=\"token punctuation\">(</span>rsFitz <span class=\"token operator\">+</span> <span class=\"token string\">'(?='</span> <span class=\"token operator\">+</span> rsFitz <span class=\"token operator\">+</span> <span class=\"token string\">')|'</span> <span class=\"token operator\">+</span> rsSymbol <span class=\"token operator\">+</span> rsSeq<span class=\"token punctuation\">,</span> <span class=\"token string\">'g'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">/** Used to detect strings with [zero-width joiners or code points from the astral planes](http://eev.ee/blog/2015/09/12/dark-corners-of-unicode/). */</span>\n<span class=\"token keyword\">var</span> reHasUnicode <span class=\"token operator\">=</span> <span class=\"token function\">RegExp</span><span class=\"token punctuation\">(</span><span class=\"token string\">'['</span> <span class=\"token operator\">+</span> rsZWJ <span class=\"token operator\">+</span> rsAstralRange  <span class=\"token operator\">+</span> rsComboRange <span class=\"token operator\">+</span> rsVarRange <span class=\"token operator\">+</span> <span class=\"token string\">']'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">/**\n * Converts a Unicode `string` to an array.\n *\n * @private\n * @param {string} string The string to convert.\n * @returns {Array} Returns the converted array.\n */</span>\n<span class=\"token keyword\">function</span> <span class=\"token function\">unicodeToArray</span><span class=\"token punctuation\">(</span>string<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> string<span class=\"token punctuation\">.</span><span class=\"token function\">match</span><span class=\"token punctuation\">(</span>reUnicode<span class=\"token punctuation\">)</span> <span class=\"token operator\">||</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n\n<span class=\"token comment\">/**\n * Checks if `string` contains Unicode symbols.\n *\n * @private\n * @param {string} string The string to inspect.\n * @returns {boolean} Returns `true` if a symbol is found, else `false`.\n */</span>\n<span class=\"token keyword\">function</span> <span class=\"token function\">hasUnicode</span><span class=\"token punctuation\">(</span>string<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> reHasUnicode<span class=\"token punctuation\">.</span><span class=\"token function\">test</span><span class=\"token punctuation\">(</span>string<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token comment\">/**\n * Converts an ASCII `string` to an array.\n *\n * @private\n * @param {string} string The string to convert.\n * @returns {Array} Returns the converted array.\n */</span>\n<span class=\"token keyword\">function</span> <span class=\"token function\">asciiToArray</span><span class=\"token punctuation\">(</span>string<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> string<span class=\"token punctuation\">.</span><span class=\"token function\">split</span><span class=\"token punctuation\">(</span><span class=\"token string\">''</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token comment\">/**\n * Converts `string` to an array.\n *\n * @private\n * @param {string} string The string to convert.\n * @returns {Array} Returns the converted array.\n */</span>\n<span class=\"token keyword\">function</span> <span class=\"token function\">stringToArray</span><span class=\"token punctuation\">(</span>string<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token function\">hasUnicode</span><span class=\"token punctuation\">(</span>string<span class=\"token punctuation\">)</span>\n    <span class=\"token operator\">?</span> <span class=\"token function\">unicodeToArray</span><span class=\"token punctuation\">(</span>string<span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">:</span> <span class=\"token function\">asciiToArray</span><span class=\"token punctuation\">(</span>string<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">var</span> toArray <span class=\"token operator\">=</span> stringToArray\n<span class=\"token comment\">/**\n * å®‰å…¨çš„å­—ç¬¦ä¸²åˆ‡å‰²\n *\n * @private\n * @param {string} str å¾…åˆ‡å‰²çš„å­—ç¬¦ä¸²\n * @param {number} start åˆ‡å‰²èµ·å§‹ä½ç½®\n * @param {number} len åˆ‡å‰²é•¿åº¦\n * @returns {string} è¿”å›åˆ‡å‰²å¥½çš„å­—ç¬¦ä¸²\n */</span>\n<span class=\"token keyword\">function</span> <span class=\"token function\">safeSubstring</span> <span class=\"token punctuation\">(</span>str<span class=\"token punctuation\">,</span> start<span class=\"token punctuation\">,</span> len<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token function\">toArray</span><span class=\"token punctuation\">(</span>str<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">splice</span><span class=\"token punctuation\">(</span>start<span class=\"token punctuation\">,</span> len<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">join</span><span class=\"token punctuation\">(</span><span class=\"token string\">''</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token comment\">/**\n * @example\n * var test = safeSubstring('æˆ‘çˆ±å¤§å®¶ğŸ‘¨â€ğŸ‘©â€ğŸ‘§â€ğŸ‘¦å“¦~', 0 , 5)\n * console.clear()\n * console.log([\n *  test,\n *  encodeURI(test),\n *  decodeURI(encodeURI(test)),\n * ])\n */</span></code></pre></div>","frontmatter":{"title":"æ€ä¹ˆåˆ‡å‰²emojiğŸ˜®","date":"February 23, 2019"}}},"pageContext":{"slug":"/2019-02-23/","previous":{"fields":{"slug":"/2019-01-02/"},"frontmatter":{"title":"2019å¹´å†™çš„2018å¹´ç»ˆæ€»ç»“"}},"next":{"fields":{"slug":"/2019-06-23/"},"frontmatter":{"title":"jwtæ¼«è°ˆ"}}}}